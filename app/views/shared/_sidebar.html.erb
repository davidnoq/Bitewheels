<!-- Sidebar Toggle Button (Visible on Small Screens) -->
<nav class="navbar navbar-dark bg-dark d-lg-none">
  <div class="container-fluid">
    <button class="btn text-white" type="button" data-bs-toggle="offcanvas" data-bs-target="#sidebarOffcanvas" aria-controls="sidebarOffcanvas">
      â˜° Menu
    </button>
  </div>
</nav>

<!-- Offcanvas Sidebar for Small Screens -->
<div class="offcanvas offcanvas-start bg-dark text-white" tabindex="-1" id="sidebarOffcanvas" aria-labelledby="sidebarOffcanvasLabel">
  <div class="offcanvas-header">
    <h4 class="d-flex align-items-center">
      <%= image_tag "svgs/logo.svg", alt: "Logo", class: "me-2", style: "height: 60px;" %>
      <a class="navbar-brand text-white" href="<%= root_path %>">Bitewheels</a>
    </h4>
    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <hr class="text-secondary">
  
  <div class="offcanvas-body d-flex flex-column justify-content-between">
    <div>
      <% if current_user %>
        <% if current_user.foodtruckowner? || current_user.eventorganizer? %>
          <!-- Authenticated User Navigation Links -->
          <ul class="nav flex-column mb-4">
            <% if current_user.foodtruckowner? %>
              <!-- Navigation for Food Truck Owners -->
              <li class="nav-item mb-3">
                <a class="nav-link text-white" href="<%= food_trucks_path %>">
                  <i class="bi bi-truck me-2"></i> Food Trucks
                </a>
              </li>
              <li class="nav-item mb-3">
                <a class="nav-link text-white" href="<%= event_applications_path %>">
                  <i class="bi bi-folder2-open me-2"></i> Applications
                </a>
              </li>
              <li class="nav-item mb-3">
                <a class="nav-link text-white" href="<%= all_events_path %>">
                  <i class="bi bi-calendar-event me-2"></i> All Events
                </a>
              </li>
              <li class="nav-item mb-3">
                <a class="nav-link text-white" href="<%= purchase_credits_path %>">
                  <i class="bi bi-wallet2 me-2"></i> Purchase Credits
                </a>
              </li>
            <% elsif current_user.eventorganizer? %>
              <!-- Navigation for Event Organizers -->
              <li class="nav-item mb-3">
                <a class="nav-link text-white" href="<%= event_applications_path %>">
                  <i class="bi bi-folder2-open me-2"></i> Applications
                </a>
              </li>
              <li class="nav-item mb-3">
                <a class="nav-link text-white" href="<%= events_path %>">
                  <i class="bi bi-calendar-week me-2"></i> My Events
                </a>
              </li>
              <li class="nav-item mb-3">
                <a class="nav-link text-white" href="<%= all_events_path %>">
                  <i class="bi bi-calendar-event me-2"></i> All Events
                </a>
              </li>
              
            <% end %>
          </ul>
        <% else %>
          <!-- Additional Roles Can Be Added Here -->
        <% end %>
      <% else %>
        <!-- Default Sidebar for Non-Authenticated Users -->
        <ul class="nav flex-column mb-4">
          <li class="nav-item mb-3">
            <a class="nav-link text-white" href="<%= root_path %>">Home</a>
          </li>
          <li class="nav-item mb-3">
            <a class="nav-link text-white" href="<%= new_user_session_path %>">Log In</a>
          </li>
          <li class="nav-item mb-3">
            <a class="nav-link text-white" href="<%= new_user_registration_path %>">Sign Up</a>
          </li>
        </ul>
      <% end %>
    </div>

    <% if current_user && (current_user.foodtruckowner? || current_user.eventorganizer?) %>
      <!-- User Information and Account Actions at Bottom -->
      <div class="mt-4">
        <hr class="text-secondary">
        <div class="d-flex align-items-center">
          <i class="bi bi-person-circle me-3" style="font-size: 1.5rem;"></i>
          <div>
            <strong><%= current_user.first_name %></strong>
            <div class="small text-secondary"><%= current_user.email %></div>
            <div><strong>Your Credits:</strong> <%= current_user.credits %></div>
          </div>
        </div>
        <div class="mt-3">
          <h6 class="text-white">Account Actions</h6>
          <ul class="list-unstyled">
            <li class="mt-2">
              <%= link_to "View Profile", user_profile_path, class: "btn btn-sm btn-outline-light w-100" %>
            </li>
            <li class="mt-2">
              <%= button_to "Sign Out", destroy_user_session_path, method: :delete, class: "btn btn-sm btn-outline-danger w-100" %>
            </li>
          </ul>
        </div>
      </div>
    <% end %>
  </div>
</div>

<!-- Fixed Sidebar for Large Screens -->
<div class="d-none d-lg-flex flex-column bg-dark text-white p-3" style="width: 250px; height: 100vh; overflow-y: auto; position: relative; top: 0; left: 0;">
  <div class="flex-grow-1 d-flex flex-column justify-content-between">
    <div>
      <h4 class="mb-4 d-flex align-items-center">
        <%= image_tag "svgs/logo.svg", alt: "Logo", class: "me-2", style: "height: 30px;" %>
        <a class="navbar-brand text-white" href="<%= root_path %>">Bitewheels</a>
      </h4>
      <hr class="text-secondary">

      <% if current_user %>
        <% if current_user.foodtruckowner? || current_user.eventorganizer? %>
          <!-- Navigation Links -->
          <ul class="nav flex-column mb-4">
            <% if current_user.foodtruckowner? %>
              <!-- Navigation for Food Truck Owners -->
              <li class="nav-item mb-3">
                <a class="nav-link text-white" href="<%= food_trucks_path %>">
                  <i class="bi bi-truck me-2"></i> Food Trucks
                </a>
              </li>
              <li class="nav-item mb-3">
                <a class="nav-link text-white" href="<%= event_applications_path %>">
                  <i class="bi bi-folder2-open me-2"></i> Applications
                </a>
              </li>
              <li class="nav-item mb-3">
                <a class="nav-link text-white" href="<%= all_events_path %>">
                  <i class="bi bi-calendar-week me-2"></i> All Events
                </a>
              </li>
              <li class="nav-item mb-3">
                <a class="nav-link text-white" href="<%= purchase_credits_path %>">
                  <i class="bi bi-wallet2 me-2"></i> Purchase Credits
                </a>
              </li>
            <% elsif current_user.eventorganizer? %>
              <!-- Navigation for Event Organizers -->
              
              <li class="nav-item mb-3">
                <a class="nav-link text-white" href="<%= events_path %>">
                  <i class="bi bi-calendar-event me-2"></i> </i> My Events
                </a>
              </li>
              <li class="nav-item mb-3">
                <a class="nav-link text-white" href="<%= all_events_path %>">
                  </i> 
                  <i class="bi bi-calendar-week me-2"></i>All Events
                </a>
              </li>
              
            <% end %>
          </ul>
        <% end %>
      <% else %>
        <!-- Default Sidebar for Non-Authenticated Users -->
        <ul class="nav flex-column mb-4">
          <li class="nav-item mb-3">
            <a class="nav-link text-white" href="<%= root_path %>">Home</a>
          </li>
          <li class="nav-item mb-3">
            <a class="nav-link text-white" href="<%= new_user_session_path %>">Log In</a>
          </li>
          <li class="nav-item mb-3">
            <a class="nav-link text-white" href="<%= new_user_registration_path %>">Sign Up</a>
          </li>
        </ul>
      <% end %>
    </div>

    <% if current_user && (current_user.foodtruckowner? || current_user.eventorganizer?) %>
      <!-- User Information and Account Actions at Bottom -->
      <div class="mt-4">
        <hr class="text-secondary">
        <div class="d-flex align-items-center">
          <i class="bi bi-person-circle me-3" style="font-size: 1.5rem;"></i>
          <div>
            <strong><%= current_user.first_name %></strong>
            <div class="small text-secondary"><%= current_user.email %></div>
            <%if current_user && current_user.foodtruckowner?%>
            <div><strong>Your Credits:</strong> <%= current_user.credits %></div>
            <% end%>
          </div>
        </div>
        <div class="mt-3">
          <h6 class="text-white">Account Actions</h6>
          <ul class="list-unstyled">
            <li class="mt-2">
              <%= link_to "View Profile", user_profile_path, class: "btn btn-sm btn-outline-light w-100" %>
            </li>
            <li class="mt-2">
              <%= button_to "Sign Out", destroy_user_session_path, method: :delete, class: "btn btn-sm btn-outline-danger w-100" %>
            </li>
          </ul>
        </div>
      </div>
    <% end %>
  </div>
</div>
