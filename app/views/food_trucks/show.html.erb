<% content_for :title, @food_truck.name %>

<!-- Flash Messages -->
<% if flash[:notice] %>
  <div class="alert alert-success alert-dismissible fade show text-center mx-auto mt-3" style="max-width: 60%;" role="alert">
    <%= flash[:notice] %>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>
<% elsif flash[:alert] %>
  <div class="alert alert-danger alert-dismissible fade show text-center mx-auto mt-3" style="max-width: 60%;" role="alert">
    <%= flash[:alert] %>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>
<% end %>

<div class="p-5">
  <!-- Top Section with Heading and Icon -->
  <div class="mb-4">
    <h2 class="fw-bold text-dark d-flex align-items-center justify-content-center">
      <i class="bi bi-truck me-2"></i> Food Trucks - Full Info
    </h2>
    <hr class="my-4">
  </div>

  <!-- Food Truck Details Card -->
  <div class="d-flex justify-content-center align-items-center bg-white">
    <div class="card shadow-lg" style="max-width: 800px; width: 100%; margin: auto;">
      <div class="card-body px-5 py-4">
        
        <!-- Card Title and Explanatory Text -->
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h2 class="card-title text-dark fw-bold mb-0">
            Food Truck Details
          </h2>
          <%= link_to food_trucks_path, class: "btn btn-dark" do %>
            <i class="bi bi-arrow-left-circle"></i> Food Trucks
          <% end %>
        </div>
        <p class="text-left text-secondary mb-5">
          View all the details of your food truck below.
        </p>

        <!-- Food Truck Information -->
        <div class="mb-3 mt-3">
          <%= content_tag :h5, class: 'fw-semibold text-dark' do %>
            <i class="bi bi-truck me-2"></i> Name
          <% end %>
          <p><%= @food_truck.name %></p>
        </div>

        <div class="mb-3">
          <%= content_tag :h5, class: 'fw-semibold text-dark d-flex align-items-center' do %>
            <i class="bi bi-list me-2"></i> Cuisine
          <% end %>
          <p>
            <%= @food_truck.cuisine %>
            <% if @food_truck.cuisine == 'Other' && @food_truck.other_cuisine.present? %>
              (<%= @food_truck.other_cuisine %>)
            <% end %>
          </p>
        </div>

        <!-- Permit Image -->
        <div class="mb-3">
          <%= content_tag :h5, class: 'fw-semibold text-dark d-flex align-items-center' do %>
            <i class="bi bi-file-earmark-text me-2"></i> Permit Image
          <% end %>
          <% if @food_truck.permit.attached? %>
            <%= image_tag url_for(@food_truck.permit), class: 'img-fluid img-thumbnail', alt: 'Permit Image', style: 'max-width: 300px; height: 100px;' %>
          <% else %>
            <p><em>No permit uploaded.</em></p>
          <% end %>
        </div>

        <!-- Menu Images -->
        <div class="mb-3">
          <%= content_tag :h5, class: 'fw-semibold text-dark d-flex align-items-center' do %>
            <i class="bi bi-card-image me-2"></i> Menu Images
          <% end %>
          <% if @food_truck.menu_images.any? %>
            <div class="row">
              <% @food_truck.menu_images.each do |menu_image| %>
                <div class="col-md-4 mb-2">
                  <%= image_tag url_for(menu_image), class: 'img-fluid img-thumbnail', alt: 'Menu Image', style: 'max-width: 150px; height: 100px;' %>
                </div>
              <% end %>
            </div>
          <% else %>
            <p><em>No menu images available.</em></p>
          <% end %>
        </div>

        <!-- Food Images -->
        <div class="mb-3">
          <%= content_tag :h5, class: 'fw-semibold text-dark d-flex align-items-center' do %>
            <i class="bi bi-egg-fried me-2"></i> Food Images
          <% end %>
          <% if @food_truck.food_images.any? %>
            <div class="row">
              <% @food_truck.food_images.each do |food_image| %>
                <div class="col-md-4 mb-2">
                  <%= image_tag url_for(food_image), class: 'img-fluid img-thumbnail', alt: 'Food Image', style: 'max-width: 150px; height: 100px;' %>
                </div>
              <% end %>
            </div>
          <% else %>
            <p><em>No food images available.</em></p>
          <% end %>
        </div>

        <!-- Actions for Food Truck Owners -->
        <% if current_user.foodtruckowner? %>
          <hr>
          <div class="d-flex justify-content-between mt-4">
            <%= link_to "Edit Food Truck", edit_food_truck_path(@food_truck), class: "btn btn-primary" %>
            <%= button_to "Delete Food Truck", @food_truck, method: :delete, data: { confirm: "Are you sure you want to delete this food truck?" }, class: "btn btn-danger" %>
          </div>
        <% end %>
        
      </div>
    </div>
  </div>
</div>

<!-- JavaScript for Bootstrap Validation (if needed) -->
<script>
  // Example starter JavaScript for disabling form submissions if there are invalid fields
  (function () {
    'use strict'

    // Fetch all the forms we want to apply custom Bootstrap validation styles to
    var forms = document.querySelectorAll('.needs-validation')

    // Loop over them and prevent submission
    Array.prototype.slice.call(forms)
      .forEach(function (form) {
        form.addEventListener('submit', function (event) {
          if (!form.checkValidity()) {
            event.preventDefault()
            event.stopPropagation()
          }

          form.classList.add('was-validated')
        }, false)
      })
  })()
</script>
